CVE-2017-1000112
=================

```
When building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data() to append. However in between two 
send() calls, the append path can be switched from UFO to non-UFO one, which leads to a memory corruption.

In case UFO packet lengths exceeds MTU, copy = maxfraglen - skb->len becomes negative on the non-UFO path and the branch to 
allocate new skb is taken. This triggers fragmentation and computation of fraggap = skb_prev->len - maxfraglen. Fraggap can 
exceed MTU, causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently skb_copy_and_csum_bits() writes 
out-of-bounds.

```

--------------------------

A local privilege escalation exploit for a Linux kernel with implemented UFO, named CVE-2017-1000112.

--------------------------

Status :- |Linux|Untested|Unreviewed|

--------------------------

Comments :-
This is just another privilege escalation exploit, which is dependent on UFO implementation of the kernel. Not sure if this will work, mainly because the porting of this to Android kernels can be unimaginable.

-LoneFlux

--------------------------


